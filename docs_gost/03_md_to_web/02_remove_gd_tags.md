## Удаляем теги gostdown

Чтобы использовать текст в формате Gostdown для веб-докуметации, нужно удалить некрасивые и ненужные теги для рисунков, таблиц, приложения и т.д. Один из моих коллег, эксперт в JavaScript предложил, что теги можно спрятать с помощью JavaScript. Однако я JavaScript знаю не так хорошо, как Python, а коллега свалил в Канаду, такие дела.

Поэтому вот вам скрипт на python, который берет все файлы `.md` из директории, за исключением проигнорированных, и удаляет из них паттерны Gostdown (названия и ссылки на рисунки (`{#fig}`,`[-@fig:]`), таблицы (`#tab}`,`[-@tab:]`), стили из заголовков `custom-style}`, `{.unordered}`, также удаляется брекеты `[]` из названий разделов. Не трогает: теги в названии Приложения (её руками нужно будет удалить), и ссылки на литературу (`[\@litbib]`), так как это универсальный формат, обрабатывается нормально mkdocs. 

Аналогичные действия можно выполнить вручную через редактор (например Notepad++), инструмент Поиск и Замена по регулярным выражениям.

Сценарий использования: при разработке документов одновременно для docx (ЕСПД или ЕСКД) и веб-справки (mkdocs). Из файлов для gostdown делаем stripped версию скриптом -- получаем веб-справку без лишних некрасивых тегов.

Список регулярных выражений и на что их заменять указан в коде, в переменной PATTERNS в виде списка. Если необходимо убирать какие-то еще паттерны, нужно просто добавить из в список по шаблону (pattern - регулярное выражение, replace - чем заменять). Пример списка:

```text
PATTERNS = [
    {"pattern": "{#(fig|tbl|sec):.+?(?=})}", "replace": "", "desc": "caption"},
    {"pattern": "\[-@(fig|tbl|sec):.+?(?=])]",
     "replace": "", "desc": "reference"},
    {"pattern": "{custom-style.+?(?=})}", "replace": "",
     "desc": "custom style named"},
    {"pattern": "{\..+?(?=})}", "replace": "",
     "desc": "custom style unnamed"},
    {"pattern": "# \[([А-я].+?(?=\]))\]", "replace": r"# \1",
     "desc": "headings brackets"}
]
```

Запуск: из директории, в которой находится директория с файлами. Например:

```text
img
docs <- md файлы тут
stripper.py
build.bat
..... any other files
```

Команда запуска для вывода хэлпа:

```console
python .\stripper.py --help
```

Полная команда запуска в общем случае:

```console
python .\stripper.py -s docs_gost -d docs -i *.png *.bat *.ps1 *.lua end.md begin.md
```

- `-s`, `--source` -- директория, которую копируем;
- `-d`, `--destination` -- название директории, куда копируем;
- `-i`, `--ignored` -- список игнорируемых файлов и расширения, передаются списком через пробел;
- `-a`, `-abbreviations` -- если этот флаг указан, то дополнительно добавляет в каждый файл .md ссылку на файл с аббревиатурами.
